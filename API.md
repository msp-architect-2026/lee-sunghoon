# ğŸ”Œ API ëª…ì„¸ì„œ (API Specification)

## ğŸ“Œ 1. ê¸°ë³¸ ì •ë³´ (Overview)
* **Base URL (ìš´ì˜):** `https://api.yourdomain.com/v1`
* **Base URL (ê°œë°œ):** `https://dev-api.yourdomain.com/v1`
* **Content-Type:** `application/json` (ê¸°ë³¸), `multipart/form-data` (ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹œ)
* **ì¸ì¦ ë°©ì‹:** JWT (Bearer Token, NextAuth.js ì—°ë™)

---

## âœ… 2. ê³µí†µ ê³µí†µ ìƒíƒœ ì½”ë“œ (Common Status Codes)
| HTTP Status | ì˜ë¯¸ | ì„¤ëª… |
| :--- | :--- | :--- |
| `200 OK` | ì„±ê³µ | ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë¨. |
| `202 Accepted` | ì²˜ë¦¬ ì¤‘ | ë¹„ë™ê¸° ìš”ì²­ì´ ìˆ˜ë½ë˜ì—ˆìœ¼ë©° ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì²˜ë¦¬ ì¤‘ì„. |
| `400 Bad Request` | ì˜ëª»ëœ ìš”ì²­ | í•„ìˆ˜ íŒŒë¼ë¯¸í„° ëˆ„ë½, ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ ë“±. |
| `401 Unauthorized` | ì¸ì¦ ì‹¤íŒ¨ | ìœ íš¨í•˜ì§€ ì•Šê±°ë‚˜ ë§Œë£Œëœ í† í°. |
| `429 Too Many Requests` | ì†ë„ ì œí•œ | í—ˆìš©ëœ API í˜¸ì¶œ íšŸìˆ˜ ì´ˆê³¼. |
| `500 Internal Error` | ì„œë²„ ì—ëŸ¬ | AI ì—”ì§„(ONNX/MediaPipe) ì²˜ë¦¬ ì‹¤íŒ¨ ë“± ì„œë²„ ì¸¡ ì˜ˆì™¸. |

---

## ğŸš€ 3. ì—”ë“œí¬ì¸íŠ¸ ìƒì„¸ (Endpoints)

### 3.1. í¼ìŠ¤ë„ ì»¬ëŸ¬ ë¶„ì„ ìš”ì²­ (ì´ë¯¸ì§€ ì—…ë¡œë“œ)
ì‚¬ìš©ìì˜ ì´ë¯¸ì§€ë¥¼ ì„œë²„ë¡œ ì „ì†¡í•˜ê³ , ë¹„ë™ê¸° ë¶„ì„ ì‘ì—…(Task)ì„ ì‹œì‘í•©ë‹ˆë‹¤.

* **URL:** `/analyze/upload`
* **Method:** `POST`
* **Auth Required:** Yes (Bearer Token)
* **Content-Type:** `multipart/form-data`

#### Request Parameters (Body)
| í•„ë“œëª… | íƒ€ì… | í•„ìˆ˜ ì—¬ë¶€ | ì„¤ëª… |
| :--- | :--- | :--- | :--- |
| `image` | File | **Yes** | ë¶„ì„í•  ì•ˆë©´ ì´ë¯¸ì§€ íŒŒì¼ (jpg, png, webp / ìµœëŒ€ 5MB) |

#### Response: `202 Accepted`
ë¶„ì„ì€ ë°±ê·¸ë¼ìš´ë“œ(FastAPI BackgroundTasks)ì—ì„œ ì§„í–‰ë˜ë©°, ì§„í–‰ ìƒí™©ì„ ì¶”ì í•  ìˆ˜ ìˆëŠ” `task_id`ë¥¼ ì¦‰ì‹œ ë°˜í™˜í•©ë‹ˆë‹¤.
```json
{
  "status": "processing",
  "task_id": "req_8f7d9a2b-1234-5678",
  "message": "ì´ë¯¸ì§€ ì—…ë¡œë“œê°€ ì™„ë£Œë˜ì—ˆìœ¼ë©°, AI ë¶„ì„ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

#### Response: `400 Bad Request`
```json
{
  "error_code": "INVALID_IMAGE_FORMAT",
  "message": "ì§€ì›í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ í˜•ì‹ì…ë‹ˆë‹¤. JPG ë˜ëŠ” PNGë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”."
}
```

---

### 3.2. ë¶„ì„ ê²°ê³¼ ì¡°íšŒ (Polling)
`task_id`ë¥¼ ì´ìš©í•˜ì—¬ AI ë¶„ì„ ê²°ê³¼ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. í”„ë¡ íŠ¸ì—”ë“œëŠ” ì´ ì—”ë“œí¬ì¸íŠ¸ë¥¼ 1~2ì´ˆ ê°„ê²©ìœ¼ë¡œ í´ë§(Polling)í•©ë‹ˆë‹¤.

* **URL:** `/analyze/result/{task_id}
* **Method:** `GET`
* **Auth Required:** Yes (Bearer Token)
**Path Variables**

| ë³€ìˆ˜ëª… | íƒ€ì… | í•„ìˆ˜ ì—¬ë¶€ | ì„¤ëª… |
| :--- | :--- | :--- | :--- |
| `task_id` | String | **Yes** | ì—…ë¡œë“œ APIì—ì„œ ë°œê¸‰ë°›ì€ ì‘ì—… ID |

#### Response: `200 OK` (ë¶„ì„ ì§„í–‰ ì¤‘ì¼ ë•Œ)
```json
{
  "status": "processing",
  "message": "AIê°€ ì–¼êµ´ ëœë“œë§ˆí¬ë¥¼ ì¶”ì¶œí•˜ê³  ìˆìŠµë‹ˆë‹¤..."
}
```

#### Response: `200 OK` (ë¶„ì„ ì™„ë£Œ ì‹œ)
í™”ë©´ì˜ 70%ë¥¼ ì±„ìš¸ ë©”ì¸ ì»¬ëŸ¬ ì½”ë“œì™€ í—¤ì–´/ë©”ì´í¬ì—… ì¶”ì²œ ë°ì´í„°ë¥¼ ëª¨ë‘ ë°˜í™˜í•©ë‹ˆë‹¤. ì›ë³¸ ì´ë¯¸ì§€ëŠ” ì„œë²„ì—ì„œ íŒŒê¸°ë˜ì—ˆìŠµë‹ˆë‹¤.
```json
{
  "status": "completed",
  "data": {
    "season": "Spring",
    "tone": "Warm Light",
    "main_color_hex": ["#FFB7B2", "#FFDAC1", "#E2F0CB"],
    "styling_recommendation": {
      "makeup": {
        "lip": "ì½”ë„ í•‘í¬, í”¼ì¹˜",
        "base": "ì˜ë¡œìš° ë² ì´ìŠ¤ì˜ ë°ì€ íŒŒìš´ë°ì´ì…˜"
      },
      "hair_dye": {
        "color_name": "ë°€í¬ ë¸Œë¼ìš´ (Milk Brown)",
        "recipe": "ì• ì‰¬ 8ë ˆë²¨ + ê³¨ë“œ ë¸Œë¼ìš´ ë¯¹ìŠ¤",
        "description": "ë´„ ì›œí†¤ì˜ í”¼ë¶€ë¥¼ ë”ìš± íˆ¬ëª…í•˜ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” ë¶€ë“œëŸ¬ìš´ ë¸Œë¼ìš´ ì»¬ëŸ¬ì…ë‹ˆë‹¤."
      }
    },
    "privacy_notice": "ì—…ë¡œë“œëœ ì›ë³¸ ì´ë¯¸ì§€ëŠ” ë¶„ì„ ì§í›„ ì„œë²„ì—ì„œ ì˜êµ¬ íŒŒê¸°ë˜ì—ˆìŠµë‹ˆë‹¤."
  }
}
```
